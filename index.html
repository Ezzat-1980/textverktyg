<!DOCTYPE html>
<html lang="sv">
<head>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KBHD5ZT9');</script>
<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Textverktyget.se - Din Allt-i-ett Textanalysator</title>
    <meta name="description" content="Gratis online-verktyg för avancerad textanalys, ordräknare, stavningskontroll, omvandling, rensning, extrahering, sök/ersätt och textgenerering.">
    
    <style>
/* Reset och grundläggande stilar */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
    line-height: 1.6;
    color: #333;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

/* Header */
header {
    text-align: center;
    margin-bottom: 30px;
    background: rgba(255, 255, 255, 0.95);
    padding: 30px;
    border-radius: 15px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    backdrop-filter: blur(10px);
}

header h1 {
    font-size: 2.5rem;
    color: #2c3e50;
    margin-bottom: 10px;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
}

.subtitle {
    font-size: 1.2rem;
    color: #7f8c8d;
    font-weight: 300;
}

/* Huvudinnehåll */
.main-content {
    display: grid;
    grid-template-columns: 1fr;
    gap: 30px;
}

/* Textområde */
.text-area-section {
    background: rgba(255, 255, 255, 0.95);
    padding: 25px;
    border-radius: 15px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    backdrop-filter: blur(10px);
}

.textarea-container {
    position: relative;
}

#inputText {
    width: 100%;
    min-height: 200px;
    padding: 20px;
    border: 2px solid #e0e6ed;
    border-radius: 10px;
    font-size: 16px;
    font-family: 'Courier New', monospace;
    resize: vertical;
    transition: border-color 0.3s ease;
    background: #fafbfc;
}

#inputText:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.textarea-controls {
    display: flex;
    gap: 10px;
    margin-top: 15px;
    justify-content: flex-end;
}

/* Resultatområde */
.results-container {
    margin-top: 20px;
    padding: 20px;
    background: #f8f9fa;
    border-radius: 10px;
    border-left: 4px solid #667eea;
}

.results-container h3 {
    color: #2c3e50;
    margin-bottom: 15px;
}

#resultsContent {
    background: white;
    padding: 15px;
    border-radius: 8px;
    font-family: 'Courier New', monospace;
    white-space: pre-wrap;
    max-height: 300px;
    overflow-y: auto;
    border: 1px solid #e0e6ed;
}

/* Statistik */
.stats-section {
    background: rgba(255, 255, 255, 0.95);
    padding: 25px;
    border-radius: 15px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    backdrop-filter: blur(10px);
}

.stats-section h2 {
    color: #2c3e50;
    margin-bottom: 20px;
    font-size: 1.5rem;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
}

.stat-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 15px;
    background: #f8f9fa;
    border-radius: 8px;
    border-left: 4px solid #667eea;
}

.stat-label {
    font-weight: 500;
    color: #555;
}

.stat-value {
    font-weight: bold;
    color: #2c3e50;
    font-size: 1.1rem;
}

/* Verktyg */
.tools-section {
    display: grid;
    gap: 25px;
}

.tool-category {
    background: rgba(255, 255, 255, 0.95);
    padding: 25px;
    border-radius: 15px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    backdrop-filter: blur(10px);
}

.tool-category h2 {
    color: #2c3e50;
    margin-bottom: 20px;
    font-size: 1.3rem;
    border-bottom: 2px solid #e0e6ed;
    padding-bottom: 10px;
}

.tool-buttons {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}

/* Knappar */
.btn-primary, .btn-secondary, .tool-btn {
    padding: 10px 20px;
    border: none;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
    text-decoration: none;
    display: inline-block;
    text-align: center;
}

.btn-primary {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
}

.btn-secondary {
    background: #6c757d;
    color: white;
}

.btn-secondary:hover {
    background: #5a6268;
    transform: translateY(-2px);
}

.tool-btn {
    background: #e9ecef;
    color: #495057;
    border: 1px solid #ced4da;
}

.tool-btn:hover {
    background: #667eea;
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 3px 10px rgba(102, 126, 234, 0.3);
}

.tool-btn:active {
    transform: translateY(0);
    box-shadow: 0 2px 5px rgba(102, 126, 234, 0.2);
}

/* Kontroller */
.prefix-suffix-controls, .search-replace-controls, .generator-controls, .comparison-controls {
    margin-top: 15px;
}

.prefix-suffix-controls input, .search-replace-controls input, .generator-controls input {
    padding: 10px;
    border: 1px solid #ced4da;
    border-radius: 6px;
    margin-right: 10px;
    margin-bottom: 10px;
    font-size: 14px;
}

.search-options {
    margin: 10px 0;
}

.search-options label {
    margin-right: 20px;
    font-size: 14px;
    cursor: pointer;
}

.search-options input[type="checkbox"] {
    margin-right: 5px;
}

.generator-item {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 15px;
}

.generator-item label {
    min-width: 120px;
    font-weight: 500;
}

.generator-item input[type="number"] {
    width: 80px;
    padding: 8px;
    border: 1px solid #ced4da;
    border-radius: 6px;
}

#compareText {
    width: 100%;
    min-height: 100px;
    padding: 15px;
    border: 1px solid #ced4da;
    border-radius: 8px;
    font-family: 'Courier New', monospace;
    margin-bottom: 15px;
    resize: vertical;
}

/* Feedback */
.feedback {
    position: fixed;
    top: 20px;
    right: 20px;
    padding: 15px 20px;
    border-radius: 8px;
    color: white;
    font-weight: 500;
    z-index: 1000;
    transform: translateX(100%);
    transition: transform 0.3s ease;
}

.feedback.show {
    transform: translateX(0);
}

.feedback.success {
    background: #28a745;
}

.feedback.error {
    background: #dc3545;
}

.feedback.info {
    background: #17a2b8;
}

/* Footer */
footer {
    margin-top: 50px;
    text-align: center;
    padding: 30px;
    background: rgba(255, 255, 255, 0.95);
    border-radius: 15px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    backdrop-filter: blur(10px);
}

footer p {
    color: #6c757d;
    margin-bottom: 15px;
}

.social-share {
    display: flex;
    justify-content: center;
    gap: 15px;
}

.share-btn {
    padding: 8px 16px;
    background: #667eea;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    transition: background 0.3s ease;
}

.share-btn:hover {
    background: #5a67d8;
}

/* Responsiv design */
@media (max-width: 768px) {
    .container {
        padding: 15px;
    }
    
    header h1 {
        font-size: 2rem;
    }
    
    .subtitle {
        font-size: 1rem;
    }
    
    .stats-grid {
        grid-template-columns: 1fr;
    }
    
    .tool-buttons {
        justify-content: center;
    }
    
    .textarea-controls {
        justify-content: center;
    }
    
    .social-share {
        flex-direction: column;
        align-items: center;
    }
    
    .generator-item {
        flex-direction: column;
        align-items: flex-start;
    }
    
    .feedback {
        position: relative;
        top: auto;
        right: auto;
        margin: 20px 0;
        transform: none;
    }
}

@media (max-width: 480px) {
    header {
        padding: 20px;
    }
    
    .text-area-section, .stats-section, .tool-category {
        padding: 20px;
    }
    
    .tool-btn {
        font-size: 12px;
        padding: 8px 15px;
    }
}

/* Animationer */
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.tool-category {
    animation: fadeIn 0.6s ease-out;
}

/* Highlight för sökresultat */
.highlight {
    background-color: yellow;
    padding: 2px 4px;
    border-radius: 3px;
}

/* Laddningsanimation */
.loading {
    position: relative;
    pointer-events: none;
}

.loading::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 20px;
    height: 20px;
    margin: -10px 0 0 -10px;
    border: 2px solid #f3f3f3;
    border-top: 2px solid #667eea;
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}
    </style>
    <script>
// Globala variabler
let textHistory = [];
let currentHistoryIndex = -1;

// DOM-element
const inputText = document.getElementById('inputText');
const resultsContainer = document.getElementById('resultsContainer');
const resultsContent = document.getElementById('resultsContent');
const feedback = document.getElementById('feedback');

// Statistik-element
const wordCount = document.getElementById('wordCount');
const charCount = document.getElementById('charCount');
const charCountNoSpaces = document.getElementById('charCountNoSpaces');
const lineCount = document.getElementById('lineCount');
const paragraphCount = document.getElementById('paragraphCount');
const sentenceCount = document.getElementById('sentenceCount');
const readabilityScore = document.getElementById('readabilityScore');
const avgWordLength = document.getElementById('avgWordLength');

// Event listeners
document.addEventListener('DOMContentLoaded', function() {
    // Kontrollera om inputText finns innan event listener läggs till
    if (inputText) {
        inputText.addEventListener('input', updateStats);
    }
    
    // Verktygsknapparna
    document.querySelectorAll('.tool-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            const action = this.getAttribute('data-action');
            executeAction(action);
        });
    });
    
    // Kontrollknappar
    const clearAllBtn = document.getElementById('clearAllBtn');
    const undoBtn = document.getElementById('undoBtn');
    const copyBtn = document.getElementById('copyBtn');
    const clearResultsBtn = document.getElementById('clearResultsBtn');

    if (clearAllBtn) clearAllBtn.addEventListener('click', clearAll);
    if (undoBtn) undoBtn.addEventListener('click', undo);
    if (copyBtn) copyBtn.addEventListener('click', copyText);
    if (clearResultsBtn) clearResultsBtn.addEventListener('click', clearResults);
    
    // Delningsknappar
    document.querySelectorAll('.share-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            const platform = this.getAttribute('data-platform');
            shareOnSocialMedia(platform);
        });
    });
    
    // Initial statistikuppdatering
    updateStats();
});

// Huvudfunktion för att utföra åtgärder
function executeAction(action) {
    const text = inputText.value;
    if (!text.trim() && !['generateLorem', 'generateRandomWords'].includes(action)) {
        showFeedback('Vänligen ange text först!', 'error');
        return;
    }
    
    saveToHistory();
    
    let result;
    let showInResults = false;
    
    const searchText = document.getElementById('searchText') ? document.getElementById('searchText').value : '';
    const replaceText = document.getElementById('replaceText') ? document.getElementById('replaceText').value : '';
    const caseSensitive = document.getElementById('caseSensitive') ? document.getElementById('caseSensitive').checked : false;
    const useRegex = document.getElementById('useRegex') ? document.getElementById('useRegex').checked : false;

    const loremWordsInput = document.getElementById('loremWords');
    const randomWordsCountInput = document.getElementById('randomWordsCount');
    const loremWords = loremWordsInput ? parseInt(loremWordsInput.value) : 50;
    const randomWordsCount = randomWordsCountInput ? parseInt(randomWordsCountInput.value) : 10;

    const prefixInput = document.getElementById('prefixInput');
    const suffixInput = document.getElementById('suffixInput');
    const prefix = prefixInput ? prefixInput.value : '';
    const suffix = suffixInput ? suffixInput.value : '';


    switch(action) {
        case 'uppercase':
            result = text.toUpperCase();
            break;
        case 'lowercase':
            result = text.toLowerCase();
            break;
        case 'sentenceCase':
            result = toSentenceCase(text);
            break;
        case 'titleCase':
            result = toTitleCase(text);
            break;
        case 'camelCase':
            result = toCamelCase(text);
            break;
        case 'kebabCase':
            result = toKebabCase(text);
            break;
        case 'snakeCase':
            result = toSnakeCase(text);
            break;
            
        case 'reverseText':
            result = text.split('').reverse().join('');
            break;
        case 'reverseWords':
            result = text.split(/\s+/).reverse().join(' ');
            break;
        case 'reverseLines':
            result = text.split('\n').reverse().join('\n');
            break;
        case 'shuffleWords':
            result = shuffleArray(text.split(' ')).join(' ');
            break;
        case 'shuffleLines':
            result = shuffleArray(text.split('\n')).join('\n');
            break;
        case 'sortLines':
            result = text.split('\n').sort().join('\n');
            break;
        case 'sortLinesDesc':
            result = text.split('\n').sort().reverse().join('\n');
            break;
            
        case 'removeExtraSpaces':
            result = text.replace(/\s+/g, ' ').trim();
            break;
        case 'removeEmptyLines':
            result = text.split('\n').filter(line => line.trim() !== '').join('\n');
            break;
        case 'removeNumbers':
            result = text.replace(/\d/g, '');
            break;
        case 'removeDuplicateLines':
            result = [...new Set(text.split('\n'))].join('\n');
            break;
        case 'removeSpecialChars':
            result = text.replace(/[^a-zA-ZÀ-ÿ0-9\s]/g, '');
            break;
        case 'removeHtmlTags':
            result = text.replace(/<[^>]*>/g, '');
            break;
        case 'trimLines':
            result = text.split('\n').map(line => line.trim()).join('\n');
            break;
            
        case 'addLineNumbers':
            result = text.split('\n').map((line, index) => `${index + 1}. ${line}`).join('\n');
            break;
        case 'addBulletPoints':
            result = text.split('\n').map(line => line.trim() ? `• ${line}` : line).join('\n');
            break;
        case 'addNumberedList':
            result = text.split('\n').map((line, index) => line.trim() ? `${index + 1}. ${line}` : line).join('\n');
            break;
        case 'indentText':
            result = text.split('\n').map(line => `    ${line}`).join('\n');
            break;
        case 'wrapText':
            result = wrapText(text, 80);
            break;
        case 'addPrefixSuffix':
            result = addPrefixSuffix(text, prefix, suffix);
            break;
            
        case 'toBase64':
            result = btoa(unescape(encodeURIComponent(text)));
            break;
        case 'fromBase64':
            try {
                result = decodeURIComponent(escape(atob(text)));
            } catch (e) {
                showFeedback('Ogiltig Base64-sträng!', 'error');
                return;
            }
            break;
        case 'urlEncode':
            result = encodeURIComponent(text);
            break;
        case 'urlDecode':
            result = decodeURIComponent(text);
            break;
        case 'toHtml':
            result = text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\n/g, '<br>');
            break;
        case 'fromHtml':
            result = text.replace(/<br>/g, '\n').replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&amp;/g, '&');
            break;
        case 'toJson':
            result = JSON.stringify(text.split('\n'));
            break;
            
        case 'extractEmails':
            result = extractEmails(text);
            showInResults = true;
            break;
        case 'extractUrls':
            result = extractUrls(text);
            showInResults = true;
            break;
        case 'extractNumbers':
            result = extractNumbers(text);
            showInResults = true;
            break;
        case 'extractPhones':
            result = extractPhones(text);
            showInResults = true;
            break;
        case 'extractUniqueWords':
            result = extractUniqueWords(text);
            showInResults = true;
            break;
        case 'wordFrequency':
            result = getWordFrequency(text);
            showInResults = true;
            break;
            
        case 'replaceAll':
            result = performReplace(text);
            break;
        case 'highlightMatches':
            result = highlightMatches(text);
            showInResults = true;
            break;
            
        case 'generateLorem':
            result = generateLoremIpsum();
            break;
        case 'generateRandomWords':
            result = generateRandomWords();
            break;
            
        case 'compareTexts':
            result = compareTexts(text);
            showInResults = true;
            break;
            
        default:
            showFeedback('Okänd åtgärd!', 'error');
            return;
    }
    
    if (showInResults) {
        showResults(result);
    } else {
        inputText.value = result;
        updateStats();
    }
    
    showFeedback('Åtgärd utförd!', 'success');
}

function toSentenceCase(text) {
    return text.toLowerCase().replace(/(^\w|\.\s+\w)/g, match => match.toUpperCase());
}

function toTitleCase(text) {
    return text.replace(/\w\S*/g, txt => 
        txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase()
    );
}

function toCamelCase(text) {
    return text.replace(/(?:^\w|[A-Z]|\b\w)/g, (word, index) => 
        index === 0 ? word.toLowerCase() : word.toUpperCase()
    ).replace(/\s+/g, '');
}

function toKebabCase(text) {
    return text.replace(/\s+/g, '-').toLowerCase();
}

function toSnakeCase(text) {
    return text.replace(/\s+/g, '_').toLowerCase();
}

function shuffleArray(array) {
    const newArray = [...array];
    for (let i = newArray.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
    }
    return newArray;
}

function wrapText(text, width) {
    return text.replace(new RegExp(`(.{1,${width}})(\\s|$)`, 'g'), '$1\n').trim();
}

function addPrefixSuffix(text) {
    const prefix = document.getElementById('prefixInput').value;
    const suffix = document.getElementById('suffixInput').value;
    
    return text.split('\n').map(line => 
        line.trim() ? `${prefix}${line}${suffix}` : line
    ).join('\n');
}

function extractEmails(text) {
    const emailRegex = /\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/g;
    const emails = text.match(emailRegex) || [];
    return [...new Set(emails)].join('\n');
}

function extractUrls(text) {
    const urlRegex = /https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)/g;
    const urls = text.match(urlRegex) || [];
    return [...new Set(urls)].join('\n');
}

function extractNumbers(text) {
    const numberRegex = /\d+/g;
    const numbers = text.match(numberRegex) || [];
    return [...new Set(numbers)].join('\n');
}

function extractPhones(text) {
    const phoneRegex = /(\+?\d{1,4}[-.\s]?)?(\(?\d{1,4}\)?[-.\s]?)?[\d\-.\s]{7,}/g;
    const phones = text.match(phoneRegex) || [];
    return [...new Set(phones)].join('\n');
}

function extractUniqueWords(text) {
    const words = text.toLowerCase().match(/\b\w+\b/g) || [];
    return [...new Set(words)].sort().join('\n');
}

function getWordFrequency(text) {
    const words = text.toLowerCase().match(/\b\w+\b/g) || [];
    const frequency = {};
    
    words.forEach(word => {
        frequency[word] = (frequency[word] || 0) + 1;
    });
    
    return Object.entries(frequency)
        .sort((a, b) => b[1] - a[1])
        .map(([word, count]) => `${word}: ${count}`)
        .join('\n');
}

function performReplace(text) {
    const searchText = document.getElementById('searchText').value;
    const replaceText = document.getElementById('replaceText').value;
    const caseSensitive = document.getElementById('caseSensitive').checked;
    const useRegex = document.getElementById('useRegex').checked;
    
    if (!searchText) {
        showFeedback('Ange text att söka efter!', 'error');
        return text;
    }
    
    try {
        if (useRegex) {
            const flags = caseSensitive ? 'g' : 'gi';
            const regex = new RegExp(searchText, flags);
            return text.replace(regex, replaceText);
        } else {
            const flags = caseSensitive ? 'g' : 'gi';
            const regex = new RegExp(escapeRegExp(searchText), flags);
            return text.replace(regex, replaceText);
        }
    } catch (e) {
        showFeedback('Ogiltigt reguljärt uttryck!', 'error');
        return text;
    }
}

function highlightMatches(text) {
    const searchText = document.getElementById('searchText').value;
    const caseSensitive = document.getElementById('caseSensitive').checked;
    const useRegex = document.getElementById('useRegex').checked;
    
    if (!searchText) {
        showFeedback('Ange text att söka efter!', 'error');
        return text;
    }
    
    try {
        if (useRegex) {
            const flags = caseSensitive ? 'g' : 'gi';
            const regex = new RegExp(searchText, flags);
            return text.replace(regex, match => `<mark>${match}</mark>`);
        } else {
            const flags = caseSensitive ? 'g' : 'gi';
            const regex = new RegExp(escapeRegExp(searchText), flags);
            return text.replace(regex, match => `<mark>${match}</mark>`);
        }
    } catch (e) {
        showFeedback('Ogiltigt reguljärt uttryck!', 'error');
        return text;
    }
}

function escapeRegExp(string) {
    return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
}

function generateLoremIpsum() {
    const wordCount = parseInt(document.getElementById('loremWords').value) || 50;
    const loremWords = [
        'lorem', 'ipsum', 'dolor', 'sit', 'amet', 'consectetur', 'adipiscing', 'elit',
        'sed', 'do', 'eiusmod', 'tempor', 'incididunt', 'ut', 'labore', 'et', 'dolore',
        'magna', 'aliqua', 'enim', 'ad', 'minim', 'veniam', 'quis', 'nostrud',
        'exercitation', 'ullamco', 'laboris', 'nisi', 'aliquip', 'ex', 'ea', 'commodo',
        'consequat', 'duis', 'aute', 'irure', 'in', 'reprehenderit', 'voluptate',
        'velit', 'esse', 'cillum', 'fugiat', 'nulla', 'pariatur', 'excepteur', 'sint',
        'occaecat', 'cupidatat', 'non', 'proident', 'sunt', 'culpa', 'qui', 'officia',
        'deserunt', 'mollit', 'anim', 'id', 'est', 'laborum'
    ];
    
    let result = [];
    for (let i = 0; i < wordCount; i++) {
        result.push(loremWords[Math.floor(Math.random() * loremWords.length)]);
    }
    
    return result.join(' ');
}

function generateRandomWords() {
    const wordCount = parseInt(document.getElementById('randomWordsCount').value) || 10;
    const randomWords = [
        'hus', 'bil', 'träd', 'bok', 'dator', 'telefon', 'katt', 'hund', 'fågel', 'fisk',
        'sol', 'måne', 'stjärna', 'himmel', 'hav', 'berg', 'skog', 'blomma', 'gräs', 'sten',
        'mat', 'vatten', 'eld', 'luft', 'tid', 'rum', 'musik', 'konst', 'sport', 'spel',
        'vän', 'familj', 'kärlek', 'glädje', 'sorg', 'hopp', 'dröm', 'tanke', 'idé', 'plan'
    ];
    
    let result = [];
    for (let i = 0; i < wordCount; i++) {
        result.push(randomWords[Math.floor(Math.random() * randomWords.length)]);
    }
    
    return result.join(' ');
}

function compareTexts(text) {
    const text2 = document.getElementById('compareText').value;
    if (!text2.trim()) {
        showFeedback('Ange text att jämföra med!', 'error');
        return 'Ingen jämförelsetext angiven.';
    }
    
    const lines1 = text.split('\n');
    const lines2 = text2.split('\n');
    const maxLines = Math.max(lines1.length, lines2.length);
    
    let differences = [];
    for (let i = 0; i < maxLines; i++) {
        const line1 = lines1[i] || '';
        const line2 = lines2[i] || '';
        
        if (line1 !== line2) {
            differences.push(`Rad ${i + 1}:`);
            differences.push(`  Text 1: ${line1}`);
            differences.push(`  Text 2: ${line2}`);
            differences.push('');
        }
    }
    
    if (differences.length === 0) {
        return 'Texterna är identiska.';
    }
    
    return `Skillnader hittade:\n\n${differences.join('\n')}`;
}

function updateStats() {
    const text = inputText.value;
    
    const words = text.trim() ? text.trim().split(/\s+/) : [];
    const chars = text.length;
    const charsNoSpaces = text.replace(/\s/g, '').length;
    const lines = text.split('\n').length;
    const paragraphs = text.trim() ? text.trim().split(/\n\s*\n/).filter(p => p.trim() !== '').length : 0;
    const sentences = text.trim() ? text.split(/[.!?]+/).filter(s => s.trim()).length : 0;
    
    const avgWordLen = words.length > 0 ? 
        (words.reduce((sum, word) => sum + word.length, 0) / words.length).toFixed(1) : 0;
    
    const readability = calculateReadability(text, words.length, sentences);
    
    wordCount.textContent = words.length;
    charCount.textContent = chars;
    charCountNoSpaces.textContent = charsNoSpaces;
    lineCount.textContent = lines;
    paragraphCount.textContent = paragraphs;
    sentenceCount.textContent = sentences;
    avgWordLength.textContent = avgWordLen;
    readabilityScore.textContent = readability;
}

function calculateReadability(text, wordCount, sentenceCount) {
    if (wordCount === 0 || sentenceCount === 0) return '-';
    
    const syllables = countSyllables(text);
    const avgWordsPerSentence = wordCount / sentenceCount;
    const avgSyllablesPerWord = syllables / wordCount;
    
    const score = 206.835 - (1.015 * avgWordsPerSentence) - (84.6 * avgSyllablesPerWord);
    
    return Math.max(0, Math.min(100, Math.round(score)));
}

function countSyllables(text) {
    const words = text.toLowerCase().match(/\b\w+\b/g) || [];
    let syllableCount = 0;
    
    words.forEach(word => {
        const matches = word.match(/[aeiouyåäö]+/g);
        syllableCount += matches ? matches.length : 1;
    });
    
    return syllableCount;
}

function saveToHistory() {
    const currentText = inputText.value;
    textHistory = textHistory.slice(0, currentHistoryIndex + 1);
    textHistory.push(currentText);
    currentHistoryIndex = textHistory.length - 1;
    
    if (textHistory.length > 50) {
        textHistory.shift();
        currentHistoryIndex--;
    }
}

function undo() {
    if (currentHistoryIndex > 0) {
        currentHistoryIndex--;
        inputText.value = textHistory[currentHistoryIndex];
        updateStats();
        showFeedback('Ångrad!', 'info');
    } else {
        showFeedback('Inget att ångra!', 'error');
    }
}

function clearAll() {
    saveToHistory();
    inputText.value = '';
    updateStats();
    clearResults();
    showFeedback('Allt rensat!', 'info');
}

function copyText() {
    inputText.select();
    inputText.setSelectionRange(0, 99999);
    document.execCommand('copy');
    showFeedback('Text kopierad!', 'success');
}

function showResults(content) {
    resultsContent.innerHTML = content;
    resultsContainer.style.display = 'block';
}

function clearResults() {
    resultsContainer.style.display = 'none';
    resultsContent.innerHTML = '';
}

function showFeedback(message, type) {
    feedback.textContent = message;
    feedback.className = `feedback ${type} show`;
    
    setTimeout(() => {
        feedback.classList.remove('show');
    }, 3000);
}

function shareOnSocialMedia(platform) {
    const url = encodeURIComponent(window.location.href);
    const text = encodeURIComponent('Kolla in detta fantastiska textverktyg!');
    
    let shareUrl;
    switch(platform) {
        case 'twitter':
            shareUrl = `https://twitter.com/intent/tweet?text=${text}&url=${url}`;
            break;
        case 'facebook':
            shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${url}`;
            break;
        case 'linkedin':
            shareUrl = `https://www.linkedin.com/sharing/share-offsite/?url=${url}`;
            break;
        default:
            return;
    }
    
    window.open(shareUrl, '_blank', 'width=600,height=400');
}
    </script>
</body>
</html>